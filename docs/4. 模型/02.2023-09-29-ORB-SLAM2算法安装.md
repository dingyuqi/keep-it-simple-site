---\rtitle: ORB-SLAM2算法安装\rcreateTime: 2023/09/29 15:03:59\rtags:\r  - CV\r  - 算法\rpermalink: /article/2iezf70h/\r---\r## 前言\r\r本篇博客将详细讲述我是如何在裸机状态下安装Ubuntu16.04双系统, 并安装对应版本的ROSkinetic系统. 外加在安装了这两个系统之后, 如何成功安装调试INDEMIND双目摄像头并实现ORB-SLAM算法. \r> 该文章是我本科期间实验室工作的工作笔记, 正式记录于2020年01月-02月, 现记录与此博客网站.\r<!-- more -->\r\r::: info 硬件准备\r我使用的是DELL-inspirion5488, 对于摄像头配有3.0的USB接口.\r\r请各位在安装过程中不要低于这个配置, 以免安装之后算法无法执行. \r:::\r\r整个安装过程包含以下几个大的环节. 如果你某些模块已经安装过, 可以跳过该部分.\r::: steps\r1. [安装Ubuntu16.04](/article/2iezf70h/#安装ubuntu16.04)\r   \r2. [安装ROS](/article/2iezf70h/#安装ros)\r\r3. [安装INDEMIND中ORB-SLAM算法](/article/2iezf70h/#安装indemind中orb-slam算法)\r:::\r\r## 安装Ubuntu16.04\rIDEMIND这款双目摄像头可以匹配Ubuntu18.04和Ubuntu16.04两个版本的Ubuntu, 但是最好使用Ubuntu16.04版本. \r\r由于我安装了太多遍, 忘记截图, 详细过程还请参考这篇文章: [Ubuntu-16.04 详细安装教程(图文)附下载地址](https://blog.csdn.net/wyx100/article/details/51582617)\r\r## 安装ROS\r\r::: info 参考资料\r1. [Ubuntu16.04安装ROS kinetic](https://blog.csdn.net/softimite_zifeng/article/details/78632211)\r2. [ROS kinetic官网](http://wiki.ros.org/kinetic/Installation/Ubuntu)\r3. [Ubuntu18.04.1安装ROS('E:无法定位软件包')](https://blog.csdn.net/sinat_34130812/article/details/81666728)\r:::\r\r::: important\r在安装过程中请注意ROS的版本, 一定要与自己Ubuntu的版本相匹配. \rUbuntu16.04对应的ROS版本是kinetic. 如果不清楚自己的Ubuntu对应什么版本的ROS可以自行百度. \r\r有能力的朋友可以直接去[ROS kinetic官网](http://wiki.ros.org/kinetic/Installation/Ubuntu)上面跟着官方的安装指南走, 网上多数的安装过程都是官网上的翻译. 而且官网上面能够保证使用的是最新的key. \r:::\r\r::: steps\r1. 配置Ubuntu的资源库\r    ::: important\r    安装过程中一定要使用稳定的网络!\r\r    使用手机热点最好. 绝大部分的错误都是因为网络不稳定导致的.\r    :::\r\r    ::: tip\r    Download from的网址使用阿里云的链接最为有效(如图中所示). \r    ![ubuntu资源库配置](/screen_shot/ubuntu-resource-conf.png)\r    :::\r\r\r2. 设置Ubuntu的`sources.list`\r\r    ```shell\r    sudo sh -c 'echo "deb http://packages.ros.org/ros/ubuntu $(lsb_release -sc) main" > /etc/apt/sources.list.d/ros-latest.list'\r    ```\r\r3. 设置key\r    ```shell\r    sudo apt-key adv --keyserver hkp://ha.pool.sks-keyservers.net:80 --recv-key 421C365BD9FF1F717815A3895523BAEEB01FA116\r    ```\r    ::: tip\r    如果无法连接上述服务器, 可以尝试`hkp://pgp.mit.edu:80`或者`hkp://keyserver.ubuntu.com:80`\r    :::\r\r4. 更新package\r    ```shell\r    sudo apt-get update\r    ```\r\r5. 安装ROS kinetic完整版\r    ```shell\r    sudo apt-get install ros-kinetic-desktop-full\r    ```\r    ::: tip\r    安装完可以通过下面的命令查看可用的package: \r    ```shell\r    apt-cache search ros-kinetic\r    ```\r    :::\r\r6. 初始化rosdep\r    在使用ROS之前必须要初始化, 使用下面的命令.\r\r    ```shell\r    sudo rosdep init\r    rosdep update\r    ```\r\r7. 配置环境\r\r    ```shell\r    echo "source /opt/ros/kinetic/setup.bash" >> ~/.bashrc\r    source ~/.bashrc\r    ```\r    ::: important\r    其中: `sourc ~/.bashrc` 是更新配置文件的代码, 每次更改bash文件之后都要执行该命令才能生效. \r    :::\r\r8. 安装building package的依赖\r\r    ```shell\r    sudo apt-get install python-rosinstall python-rosinstall-generator python-wstool build-essential\r    ```\r\r9. 测试ROS安装成功\r      1. 打开Termial, 输入以下命令, 初始化ROS环境: \r      ```shell\r      roscore\r      ```\r\r      2. 打开新的Termial, 输入以下命令, 弹出一个小乌龟窗口: \r\r      ```shell\r      rosrun turtlesim turtlesim_node\r      ```\r\r      3. 打开新的Termial, 输入以下命令, 可以在Termial中通过方向键控制小乌龟的移动: \r\r      ```shell\r      rosrun turtlesim turtle_teleop_key\r      ```\r      ![turtlesim运行成功](/screen_shot/turtlesim-success.png)\r\r      4. 打开新的Termial, 输入以下命令, 弹出新的窗口查看ROS节点信息: \r\r      ```shell\r      rosrun rqt_graph rqt_graph\r      ```\r      ![ROS节点信息](/screen_shot/rqt-graph-success.png)\r\r## 安装INDEMIND中ORB-SLAM算法\r::: important\r以下过程多为ubuntu18.04版本下的安装操作过程记录. 第二次ubuntu16.04版本的安装稍有不同, 不同之处以标注的形式体现, 没有截图记录. \r:::\r\r安装该摄像头的算法分为以下几个主要步骤:\r::: steps\r1. [配置环境](/article/2iezf70h/#配置环境)\r\r2. [安装SDK依赖环境](/article/2iezf70h/#安装SDK依赖环境)\r\r3. [安装SDK](/article/2iezf70h/#安装SDK)\r:::\r\r\r### 配置环境\r::: steps\r1. 安装pangolin\r    ::: info 参考资料\r    1. <https://www.cnblogs.com/liufuqiang/p/5618335.html>\r    :::\r\r    ::: important\r    在安装pangolin之前请确保以下环境已经正确安装.\r\r    1. Glew\r\r    ```shell\r    sudo apt-get install libglew-dev\r    ```\r\r    2. CMake\r\r    ```shell\r    sudo apt-get install cmake\r    ```\r\r    3. Boost\r\r    ```shell\r    sudo apt-get install libboost-dev libboost-thread-dev libboost-filesystem-dev\r    ```\r\r    4. Python \r    \r      ubuntu16.04和18.04自带Python2,无需重新安装\r    :::\r\r    在确保以上前置环境安装完毕后, 执行以下命令安装pangolin.\r\r    ``` shell\r    git clone https://github.com/stevenlovegrove/Pangolin.git\r    cd Pangolin\r    mkdir build\r    cd build\r    cmake -DCPP11_NO_BOOST=1 ..\r    make -j\r    ```\r    ::: important 安装过程中可能遇到的问题\r    1. 网络问题\r        安装过程中一定要注意网络的问题!  如果可能请尽量使用热点. \r\r        若中间报错不是'XXX package not found' 这种错误, 多半是网络不稳定造成的, 多次重新执行失败的命令即可成功.\r    2. `Package Not Found`问题\r\r        还有可能出现一些package找不到的错误, 只需要按照提示去安装相应的包即可.\r        在安装包完成之后重新执行下面两行代码即可: \r\r        ```shell\r        cmake -DCPP11_NO_BOOST=1 ..\r        make -j\r        ```\r    :::\r\r    ::: details 我在Ubuntu18.04下遇到如下问题, 仅供参考\r\r    1. ERROR1:\r      ![libpng12-dev has no installation candidate](/screen_shot/libpng12-dev-error.png)\r\r        解决方法: \r\r        ![libpng12-dev 解决方案](/screen_shot/libpng12-dev-error-solution.png)\r\r    2. ERROR2:\r      ![xkbcommon not found](/screen_shot/xkbcommon-not-found.png)\r\r        解决方法: \r\r        ![xkbcommon not found 解决方案](/screen_shot/xkbcommon-not-found-solution.png)\r\r        ```shell\r        sudo apt-get install libxkbcommon-dev\r        ```\r    :::\r2. 安装opencv3.4.3\r   \r    ::: info 参考资料\r    1. [OpenCV3环境配置(Ubuntu18.04，OpenCV3.4.3)](https://blog.csdn.net/qq_32408773/article/details/83346816)\r    :::\r\r    ::: important\r    opencv一定要安装3.4.3版本, 否则INDEMIND无法运行. \r    本文虽然是18.04的安装教程, 但是用于16.04也完全没有问题. \r    :::\r\r    1. 安装cmake和其他依赖项\r        ```shell\r        sudo apt-get update\r        sudo apt-get install cmake\r        sudo apt-get install build-essential libgtk2.0-dev libavcodec-dev libavformat-dev libjpeg.dev libtiff4.dev libswscale-dev libjasper-dev\r        ```\r    2. 在opencv官网上下载对应的版本: <https://opencv.org/releases/>\r    3. 下载完之后对文件进行解压\r    4. 进入解压后的文件夹并创建build文件夹, 并进入build\r        ```shell\r        mkdir build\r        cd build\r        ```\r    5. cmake\r\r      ```shell\r      cmake -D CMAKE_BUILD_TYPE=Release -D CMAKE_INSTALL_PREFIX=/usr/local ..\r      ```\r    6. 编译\r\r      ```shell\r      sudo make\r      ```\r    7. 执行安装命令\r\r      ```shell\r      sudo make install\r      ```\r    8. 配置环境\r      ```shell\r      sudo gedit /etc/ld.so.conf.d/opencv.conf \r      ```\r      在打开的空白文档中添加: \r\r      ```shell\r      /usr/local/lib\r      ```\r      之后执行使得修改生效: \r\r      ```shell\r      sudo ldconfig \r      ```\r\r    9. 配置bash\r\r      ```shell\r      sudo gedit /etc/bash.bashrc\r      ```\r      在打开的文件末尾添加: \r\r      ```shell\r      PKG_CONFIG_PATH=$PKG_CONFIG_PATH:/usr/local/lib/pkgconfig  \r      export PKG_CONFIG_PATH\r      ```\r      之后执行以下命令进行更新: \r\r      ```shell\r      source /etc/bash.bashrc \r      sudo updatedb\r      ```\r      配置完成！\r        \r    10.  测试\r      进入opencv-3.4.3/samples/cpp/example_cmake, 这里面是一些cmake官方程序, 执行调用摄像头程序: \r      ```shell\r       cmake .\r       make\r       ./opencv_example\r      ```\r      **如果能够调用自己电脑的摄像头, 说明安装成功！**\r\r\r3. 安装Eigen3\r\r    ```shell\r    sudo apt-get install libeigen3-dev\r    ```\r\r4. 安装DBoW2\r    ::: important\r    安装DBoW2的时候需要OpenCV的支持\r    :::\r\r    ```shell\r    git clone https://github.com/dorian3d/DBoW2\r\r    cd DBow2\r    mkdir build\r    cd build\r\r    cmake ..\r    make\r    sudo make install\r    ```\r\r5. 安装g2o\r\r    ::: info 参考资料 \r    1. [Ubuntu18.4安装g2o](https://blog.csdn.net/Coderii/article/details/87606036)\r    :::\r\r    1. 到[官网](https://github.com/RainerKuemmerle/g2o)下载压缩包\r    2. 安装依赖项\r        ```shell\r        sudo apt-get install cmake libeigen3-dev libsuitesparse-dev qtdeclarative5-dev qt5-qmake libqglviewer-dev\r        ```\r\r        其中linqglviewer-dev安装不了,如果不需要g2o的viewer模块,则不必装该依赖项.\r        \r        如果需要可以去官网直接下载,然后执行以下命令单独安装:\r\r        ``` shell\r        mkdir build\r        cd build\r        cmake …\r        make\r        sudo make install\r        ```\r    \r    3. 编译\r        ```shell\r        mkidr build\r        cd build\r        cmake ..     \r        make         \r        ```\r    4. 安装\r\r        ```shell\r        sudo make install\r        ```\r:::\r\r### 安装SDK依赖环境\r::: steps\r1. 安装 google-glog 和 gflags\r\r    ```shell\r    sudo apt-get install libgoogle-glog-dev\r    ```\r\r2. 安装 BLAS&LAPACK\r\r    ```shell\r    sudo apt-get install libatlas-base-dev\r    ```\r\r3. 安装SuiteSparse and CXSparse\r\r    ```shell\r    sudo apt-get install libsuitesparse-dev\r    ```\r:::\r\r### 安装SDK\r::: important\rubuntu16.04必须使用GCC5.4进行编译, 否则可能链接失败.\r:::\r\r::: info 参考资料\r1. <https://indemind-sdk.readthedocs.io/zh_CN/latest/src/sdk/ros%20SDK%20anzhuang.html>\r2.  INDEMIND微信公众号上ORB-SLAM的教程\r:::\r\r::: steps\r1. 下载SDK和源码\r    下载地址: \r    SDK: [https://github.com/INDEMIND/SDK-Linux](https://github.com/INDEMIND/SDK-Linux)\r    ORB-SLAM: [https://github.com/INDEMINDtech/run.ORB](https://github.com/INDEMINDtech/run.ORB)\r\r\r2. 进行SDK的安装\r      1. 下载好SDK 后, 进入`SDK-Linux/demo_ros/src`目录. 将下载好的ORB-SLAM2放在该目录下.\r      2. 将下载的`CMakeList.txt`替换到`...SDK/demo_ros/src`目录下\r      3. 进入`sdk/demo_ros/src/ORB_SLAM2/Vocabulary`目录下执行:\r         \r          ```shell\r          tar -xf ORBvoc.txt.tar.gz\r          ```\r      4. 在Linux SDK的`demo_ros`文件夹下打开终端使用命令来进行编译: \r\r          ```shell\r          catkin_make\r          ```\r\r          执行成功之后会在`demo_ros`文件夹之下生成两个执行文件: \r\r            1. module_driver \r            2. stereo_euroc\r             \r      5. 打开一个新的终端, 执行: \r\r          ```shell\r          roscore\r          ```\r      6. 将`module_driver`拷贝到`SDK/lib/1604`下, 打开终端执行\r\r          ```shell\r          sudo -s\r          sudo chmod 777 ./run.sh\r          ./run.sh\r          ```\r\r      7. 进入`SDK/demo_ros`目录下, 打开终端, 执行\r\r          ```shell\r          ./stereo_euroc\r          ```\r:::\r\r## 总结\r:tada: :tada: 当你完成上述的所有步骤, 你此时应该能够得到一个实时的ORM-SLAM算法 :tada: :tada: